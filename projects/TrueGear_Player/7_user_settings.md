# 用户配置模块

`TrueGear_PlayerApp.Services.AppSetting` 继承于 `System.Configuration.ApplicationSettingsBase`

## 主要特点

1. 用户和程序应用范围设置
   1. 支持用户特定设置和全局应用程序设置
      1. 用户设置存储在用户配置文件中 --> C:\Users\<用户名>\AppData\Local\<应用程序名>\<版本>\user.config
      2. 应用程序设置存储在程序数据目录 --> 存储在程序的安装目录下 xxx\<应用程序名>.exe.config
2. 强类型访问：通过定义属性来强类型访问设置，支持不同的数据类型
3. 自动保存：通过调用`Save`方法，自动保存更改的设置
4. 默认值：为设置提供默认值，方便首次运行使用

> Warning:
> 应用程序全局设置，存在更新程序时被覆盖的问题
> 用户特定设置，存在不同版本的话，用户设置的配置无法同步到新版本的配置文件中的问题

## 拓展思考

比较好的配置方案能够实现以下功能：

1. JSON/XML 文件：易于阅读和修改，可支持版本控制
2. 用户特定设置
3. 程序全局设置
4. 版本控制和迁移
5. 设置覆盖
6. 设置变更通知

想到的方案：

1. 使用 JSON 存储配置
2. 先加载程序默认配置，再加载全局设置，最后根据用户登录情况选择是否加载用户特定设置
   1. 后加载配置覆盖前加载配置
   2. 支持配置热插拔
   3. 发布配置变更事件
   4. 订阅特定事件触发配置变更
3. 更新处理
   1. 覆盖程序默认配置（存放在安装包路径下）
   2. 全局设置文件存放在 C:\ProgramData\<应用程序名>\globalconfig.json
   3. 用户特定设置文件存放在 C:\ProgramData\<应用程序名>\userconfig_uuid.json
4. 用户登录
   1. 下载用户配置文件 -- UI动效
   2. 加载用户配置
